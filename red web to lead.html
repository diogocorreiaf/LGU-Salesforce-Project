<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Application Form</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .error-message {
            display: none;
            color: #ef4444;
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }
        .error-message.show {
            display: block;
        }
        .input-error {
            border-color: #ef4444 !important;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-red-50 to-rose-100 min-h-screen py-12 px-4">
    <div class="max-w-2xl mx-auto">
        <div class="bg-white rounded-2xl shadow-xl p-8">
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-gray-800 mb-2">Student Application</h1>
                <p class="text-gray-600">Please fill out all required fields to submit your application</p>
            </div>

            <form id="leadForm" action="https://webto.salesforce.com/servlet/servlet.WebToLead?encoding=UTF-8&orgId=00DWU00000X29Dt" method="POST" novalidate>
                
                <input type="hidden" name="oid" value="00DWU00000X29Dt">
                <input type="hidden" name="retURL" value="file:///C:/Users/DiogoCorreia/Desktop/Web%20to%20lead%20v2.html">
                <input type="hidden" name="lead_source" value="Web">

                <!-- Personal Information Section -->
                <div class="mb-8">
                    <h2 class="text-xl font-semibold text-gray-700 mb-4 pb-2 border-b-2 border-red-500">Personal Information</h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="first_name" class="block text-sm font-medium text-gray-700 mb-2">
                                First Name <span class="text-red-500">*</span>
                            </label>
                            <input 
                                type="text" 
                                id="first_name" 
                                name="first_name" 
                                maxlength="40" 
                                required
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition"
                                placeholder="Enter first name"
                            >
                            <div class="error-message" id="first_name_error">Please enter a valid name (letters only)</div>
                        </div>

                        <div>
                            <label for="last_name" class="block text-sm font-medium text-gray-700 mb-2">
                                Last Name <span class="text-red-500">*</span>
                            </label>
                            <input 
                                type="text" 
                                id="last_name" 
                                name="last_name" 
                                maxlength="80" 
                                required
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition"
                                placeholder="Enter last name"
                            >
                            <div class="error-message" id="last_name_error">Please enter a valid name (letters only)</div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
                        <div>
                            <label for="mobile" class="block text-sm font-medium text-gray-700 mb-2">
                                Mobile <span class="text-red-500">*</span>
                            </label>
                            <input 
                                type="tel" 
                                id="mobile" 
                                name="mobile" 
                                maxlength="40" 
                                required
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition"
                                placeholder="+351 912 345 678"
                            >
                            <div class="error-message" id="mobile_error">Mobile must be in format +123456789 (6-15 digits)</div>
                        </div>

                        <div>
                            <label for="email" class="block text-sm font-medium text-gray-700 mb-2">
                                Email <span class="text-red-500">*</span>
                            </label>
                            <input 
                                type="email" 
                                id="email" 
                                name="email" 
                                maxlength="80"
                                required
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition"
                                placeholder="your.email@example.com"
                            >
                            <div class="error-message" id="email_error">Please enter a valid email</div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
                        <div>
                            <label for="birthdate_display" class="block text-sm font-medium text-gray-700 mb-2">
                                Birthdate <span class="text-red-500">*</span>
                            </label>
                            <input 
                                type="date" 
                                id="birthdate_display" 
                                required
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition"
                            >
                            <input 
                                type="hidden" 
                                id="00NWU00001DILOR" 
                                name="00NWU00001DILOR"
                            >
                            <div class="error-message" id="birthdate_error">You must be at least 10 years old</div>
                        </div>

                        <div>
                            <label for="00NWU00001EAZvB" class="block text-sm font-medium text-gray-700 mb-2">
                                Gender
                            </label>
                            <select 
                                id="00NWU00001EAZvB" 
                                name="00NWU00001EAZvB"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition bg-white"
                            >
                                <option value="">Select gender</option>
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                                <option value="Non Binary">Non Binary</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Academic Information Section -->
                <div class="mb-8">
                    <h2 class="text-xl font-semibold text-gray-700 mb-4 pb-2 border-b-2 border-red-500">Academic Information</h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="00NWU00001Dsjg5" class="block text-sm font-medium text-gray-700 mb-2">
                                Academic Year <span class="text-red-500">*</span>
                            </label>
                            <select 
                                id="00NWU00001Dsjg5" 
                                name="00NWU00001Dsjg5" 
                                required
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition bg-white"
                            >
                                <option value="">Select academic year</option>
                                <option value="2025/2026">2025/2026</option>
                                <option value="2026/2027">2026/2027</option>
                                <option value="2027/2028">2027/2028</option>
                                <option value="2028/2029">2028/2029</option>
                                <option value="2029/2030">2029/2030</option>
                                <option value="2030/2031">2030/2031</option>
                                <option value="2031/2032">2031/2032</option>
                                <option value="2032/2033">2032/2033</option>
                                <option value="2033/2034">2033/2034</option>
                                <option value="2034/2035">2034/2035</option>
                                <option value="2035/2036">2035/2036</option>
                            </select>
                            <div class="error-message" id="academic_year_error">Please select an academic year</div>
                        </div>

                        <div>
                            <label for="00NWU00001DtCi5" class="block text-sm font-medium text-gray-700 mb-2">
                                Grade Average
                            </label>
                            <select 
                                id="00NWU00001DtCi5" 
                                name="00NWU00001DtCi5"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition bg-white"
                            >
                                <option value="">Select grade average</option>
                                <option value="A+">A+</option>
                                <option value="A">A</option>
                                <option value="B">B</option>
                                <option value="C">C</option>
                                <option value="D">D</option>
                                <option value="E">E</option>
                                <option value="U">U</option>
                            </select>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
                        <div>
                            <label for="00NWU00001DIDtH" class="block text-sm font-medium text-gray-700 mb-2">
                                Highest Education Level
                            </label>
                            <select 
                                id="00NWU00001DIDtH" 
                                name="00NWU00001DIDtH"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition bg-white"
                            >
                                <option value="">Select education level</option>
                                <option value="High School">High School</option>
                                <option value="Bachelor">Bachelor</option>
                                <option value="Master">Master</option>
                                <option value="PhD">PhD</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Course Information Section -->
                <div class="mb-8">
                    <h2 class="text-xl font-semibold text-gray-700 mb-4 pb-2 border-b-2 border-red-500">Course Selection</h2>
                    
                    <div class="mb-6">
                        <label for="00NWU00001Dqu0C" class="block text-sm font-medium text-gray-700 mb-2">
                            Associated Faculty <span class="text-red-500">*</span>
                        </label>
                        <select 
                            id="00NWU00001Dqu0C" 
                            name="00NWU00001Dqu0C" 
                            required
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition bg-white"
                        >
                            <option value="">Select faculty</option>
                            <option value="Faculty of Technology">Faculty of Technology</option>
                            <option value="Faculty of Arts">Faculty of Arts</option>
                            <option value="Faculty of Business Management">Faculty of Business Management</option>
                        </select>
                        <div class="error-message" id="faculty_error">Please select a faculty</div>
                    </div>

                    <div class="mb-6">
                        <label for="00NWU00001Dskic" class="block text-sm font-medium text-gray-700 mb-2">
                            Applied Course <span class="text-red-500">*</span>
                        </label>
                        <select 
                            id="00NWU00001Dskic" 
                            name="00NWU00001Dskic" 
                            required
                            disabled
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition bg-white disabled:bg-gray-100 disabled:cursor-not-allowed"
                        >
                            <option value="">Select a faculty first</option>
                        </select>
                        <div class="error-message" id="course_error">Please select a course</div>
                    </div>

                    <div>
                        <label for="00NWU00001DA5Mk" class="block text-sm font-medium text-gray-700 mb-2">
                            Enrollment Type <span class="text-red-500">*</span>
                        </label>
                        <select 
                            id="00NWU00001DA5Mk" 
                            name="00NWU00001DA5Mk" 
                            required
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition bg-white"
                        >
                            <option value="">Select enrollment type</option>
                            <option value="In-Person">In-Person</option>
                            <option value="Online">Online</option>
                        </select>
                        <div class="error-message" id="enrollment_error">Please select an enrollment type</div>
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="mt-8">
                    <button 
                        type="submit" 
                        class="w-full bg-red-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition duration-200 transform hover:scale-[1.02]"
                    >
                        Submit Application
                    </button>
                </div>

                <p class="text-sm text-gray-500 text-center mt-4">
                    <span class="text-red-500">*</span> Required fields
                </p>
            </form>
        </div>
    </div>

    <script>
        const form = document.getElementById('leadForm');
        
        // Course options by faculty
        const coursesByFaculty = {
            "Faculty of Arts": [
                "Visual & Performing Arts",
                "Fine Arts in Creative Writing",
                "Music in Performance and Composition",
                "Arts in Theatre and Performing Arts"
            ],
            "Faculty of Technology": [
                "Computer Science",
                "Artificial Intelligence",
                "Cybersecurity Engineering"
            ],
            "Faculty of Business Management": [
                "Business Administration",
                "International Finance",
                "International Business and Relations"
            ]
        };

        // Age validation function
        function validateAge(birthdate) {
            const today = new Date();
            const birth = new Date(birthdate);
            let age = today.getFullYear() - birth.getFullYear();
            const monthDiff = today.getMonth() - birth.getMonth();
            
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) {
                age--;
            }
            
            return age >= 10;
        }

        // Mobile validation function
        function validateMobile(mobile) {
            if (!mobile || mobile.trim() === '') return false;
            const regex = /^\+[0-9]{6,15}$/;
            return regex.test(mobile);
        }

        // Name validation function
        function validateName(name) {
            if (!name || name.trim() === '') return false;
            const regex = /^[a-zA-ZÀ-ÿ\s'-]+$/;
            return regex.test(name);
        }
        
        // Email validation
        function validateEmail(email) {
            if (!email || email.trim() === '') return false;
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }

        // Show error
        function showError(fieldId, errorId) {
            const field = document.getElementById(fieldId);
            const error = document.getElementById(errorId);
            field.classList.add('input-error');
            error.classList.add('show');
        }

        // Hide error
        function hideError(fieldId, errorId) {
            const field = document.getElementById(fieldId);
            const error = document.getElementById(errorId);
            field.classList.remove('input-error');
            error.classList.remove('show');
        }

        // Function to convert date from YYYY-MM-DD to dd/mm/yyyy format for Salesforce UK locale
        function convertDateFormat(dateString) {
            if (!dateString) return '';
            const [year, month, day] = dateString.split('-');
            return `${day}/${month}/${year}`;
        }

        // Real-time validation for each field
        document.getElementById('first_name').addEventListener('blur', function() {
            if (this.value.trim() === '' || !validateName(this.value)) {
                showError('first_name', 'first_name_error');
            } else {
                hideError('first_name', 'first_name_error');
            }
        });

        document.getElementById('last_name').addEventListener('blur', function() {
            if (this.value.trim() === '' || !validateName(this.value)) {
                showError('last_name', 'last_name_error');
            } else {
                hideError('last_name', 'last_name_error');
            }
        });

        document.getElementById('mobile').addEventListener('blur', function() {
            if (!validateMobile(this.value)) {
                showError('mobile', 'mobile_error');
            } else {
                hideError('mobile', 'mobile_error');
            }
        });

        document.getElementById('email').addEventListener('blur', function() {
            if (!validateEmail(this.value)) {
                showError('email', 'email_error');
            } else {
                hideError('email', 'email_error');
            }
        });

        // Birthdate handler - sync display field with hidden Salesforce field
        document.getElementById('birthdate_display').addEventListener('change', function() {
            const dateValue = this.value;
            const hiddenField = document.getElementById('00NWU00001DILOR');
            
            if (dateValue) {
                hiddenField.value = convertDateFormat(dateValue);
            } else {
                hiddenField.value = '';
            }
            
            if (dateValue === '' || !validateAge(dateValue)) {
                showError('birthdate_display', 'birthdate_error');
            } else {
                hideError('birthdate_display', 'birthdate_error');
            }
        });

        document.getElementById('00NWU00001Dsjg5').addEventListener('change', function() {
            if (this.value === '') {
                showError('00NWU00001Dsjg5', 'academic_year_error');
            } else {
                hideError('00NWU00001Dsjg5', 'academic_year_error');
            }
        });

        document.getElementById('00NWU00001Dskic').addEventListener('change', function() {
            if (this.value === '') {
                showError('00NWU00001Dskic', 'course_error');
            } else {
                hideError('00NWU00001Dskic', 'course_error');
            }
        });

        document.getElementById('00NWU00001DA5Mk').addEventListener('change', function() {
            if (this.value === '') {
                showError('00NWU00001DA5Mk', 'enrollment_error');
            } else {
                hideError('00NWU00001DA5Mk', 'enrollment_error');
            }
        });

        // Faculty change handler - populate courses based on selected faculty
        document.getElementById('00NWU00001Dqu0C').addEventListener('change', function() {
            const faculty = this.value;
            const courseSelect = document.getElementById('00NWU00001Dskic');
            
            courseSelect.innerHTML = '<option value="">Select course</option>';
            
            if (faculty && coursesByFaculty[faculty]) {
                courseSelect.disabled = false;
                
                coursesByFaculty[faculty].forEach(course => {
                    const option = document.createElement('option');
                    option.value = course;
                    option.textContent = course;
                    courseSelect.appendChild(option);
                });
                
                hideError('00NWU00001Dqu0C', 'faculty_error');
            } else {
                courseSelect.disabled = true;
                courseSelect.innerHTML = '<option value="">Select a faculty first</option>';
            }
            
            courseSelect.value = '';
            hideError('00NWU00001Dskic', 'course_error');
        });

        // Form submission validation
        form.addEventListener('submit', function(e) {
            let isValid = true;

            // Validate First Name
            const firstName = document.getElementById('first_name').value.trim();
            if (firstName === '' || !validateName(firstName)) {
                showError('first_name', 'first_name_error');
                isValid = false;
            }

            // Validate Last Name
            const lastName = document.getElementById('last_name').value.trim();
            if (lastName === '' || !validateName(lastName)) {
                showError('last_name', 'last_name_error');
                isValid = false;
            }

            // Validate Mobile
            const mobile = document.getElementById('mobile').value;
            if (!validateMobile(mobile)) {
                showError('mobile', 'mobile_error');
                isValid = false;
            }

            // Validate Email (now required)
            const email = document.getElementById('email').value;
            if (!validateEmail(email)) {
                showError('email', 'email_error');
                isValid = false;
            }

            // Validate Birthdate
            const birthdateDisplay = document.getElementById('birthdate_display').value;
            const birthdateHidden = document.getElementById('00NWU00001DILOR').value;
            
            if (birthdateDisplay === '' || !validateAge(birthdateDisplay)) {
                showError('birthdate_display', 'birthdate_error');
                isValid = false;
            }
            
            if (birthdateDisplay && !birthdateHidden) {
                document.getElementById('00NWU00001DILOR').value = convertDateFormat(birthdateDisplay);
            }

            // Validate Academic Year
            const academicYear = document.getElementById('00NWU00001Dsjg5').value;
            if (academicYear === '') {
                showError('00NWU00001Dsjg5', 'academic_year_error');
                isValid = false;
            }

            // Validate Faculty
            const faculty = document.getElementById('00NWU00001Dqu0C').value;
            if (faculty === '') {
                showError('00NWU00001Dqu0C', 'faculty_error');
                isValid = false;
            }

            // Validate Course
            const course = document.getElementById('00NWU00001Dskic').value;
            if (course === '') {
                showError('00NWU00001Dskic', 'course_error');
                isValid = false;
            }

            // Validate Enrollment Type
            const enrollmentType = document.getElementById('00NWU00001DA5Mk').value;
            if (enrollmentType === '') {
                showError('00NWU00001DA5Mk', 'enrollment_error');
                isValid = false;
            }

            if (!isValid) {
                e.preventDefault();
                const firstError = document.querySelector('.input-error');
                if (firstError) {
                    firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }
        });
    </script>
</body>
</html>